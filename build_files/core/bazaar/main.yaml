# homeOS Bazaar Main Configuration
# This file defines hooks and advanced behavior for Bazaar

hooks:
  - id: welcome-to-homeos
    when: after-transaction
    dialogs:
      - id: welcome-dialog
        title: "Welcome to homeOS!"
        body-use-markup: true
        body: |
          ðŸŽ‰ <b>Installation Complete!</b>
          
          Your new application has been installed successfully. 
          
          <b>Tip:</b> homeOS applications are sandboxed for security and update automatically for the best experience.
          
          Enjoy using your new app!
        default-response-id: ok
        options:
          - id: ok
            string: "Great!"
            style: suggested
    shell: |
      case "$BAZAAR_HOOK_STAGE" in
          setup)
              # Only show welcome for first few installations
              if [ "$BAZAAR_TS_TYPE" = "install" ] && [ ! -f "$HOME/.config/homeos-bazaar-welcomed" ]; then
                  echo 'ok'
              else
                  echo 'pass'
              fi
              ;;
          setup-dialog)
              echo 'ok'
              ;;
          teardown-dialog)
              echo 'ok'
              ;;
          catch)
              echo 'abort'
              ;;
          action)
              # Mark that we've shown the welcome
              mkdir -p "$HOME/.config"
              touch "$HOME/.config/homeos-bazaar-welcomed"
              ;;
          teardown)
              echo 'continue'
              ;;
      esac